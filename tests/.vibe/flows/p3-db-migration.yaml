名称: Database Migration
描述: No loop, 3-way (success/partial-failure/full-rollback), cross-phase fallback

步骤:
  # ── Planning ──

  - 1.1 Plan migration strategy

  - 1.2 Migration review:
      类型: wait
      下一步:
        - 如果: "migration plan approved"
          去: 2.1 Backup database
        - 去: 1.1 Plan migration strategy

  # ── Execution ──

  - 2.1 Backup database

  - 2.2 Execute migration

  - 2.3 Verify migration:
      下一步:
        - 如果: "migration fully successful"
          去: 3.1 Post-migration validation
        - 如果: "partial failure, some tables need fixing"
          去: 2.4 Fix partial failure
        - 去: 2.5 Full rollback

  - 2.4 Fix partial failure:
      下一步: 2.3 Verify migration

  - 2.5 Full rollback:
      下一步: 1.1 Plan migration strategy

  # ── Validation ──

  - 3.1 Post-migration validation

  - Done:
      类型: terminate
      原因: Database migration complete
