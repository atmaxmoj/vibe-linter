name: Storybook-First Development
description: Story loop, visual test 2-way, chromatic review wait

steps:
  # ── Setup ──

  - 1.1 Setup Storybook config

  - 1.2 Define story list

  # ── Story Loop ──

  - 2.0 Story loop:
      iterate: "stories"
      children:
        - 2.1 Write story
        - 2.2 Implement component for story
        - 2.3 Visual test:
            next:
              - if: "visual test passes"
                go: 2.0 Story loop
              - go: 2.2 Implement component for story

  # ── Review ──

  - 3.1 Run chromatic visual review

  - 3.2 Chromatic review:
      type: wait
      next:
        - if: "chromatic review approved"
          go: 3.3 Integration
        - go: 2.0 Story loop

  - 3.3 Integration

  - Done:
      type: terminate
      reason: All stories pass visual review
