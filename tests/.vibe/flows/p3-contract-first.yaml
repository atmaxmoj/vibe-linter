name: Contract-First Development
description: Formal contract, generate stubs, endpoint loop, bidirectional integration

steps:
  # ── Contract Definition ──

  - 1.1 Define contract

  - 1.2 Contract review:
      type: wait
      next:
        - if: "contract is approved"
          go: 1.3 Generate stubs
        - go: 1.1 Define contract

  - 1.3 Generate stubs

  # ── Endpoint Loop ──

  - 2.0 Endpoint loop:
      iterate: "endpoints"
      children:
        - 2.1 Implement endpoint
        - 2.2 Contract validation:
            next:
              - if: "endpoint conforms to contract"
                go: 2.0 Endpoint loop
              - go: 2.1 Implement endpoint

  # ── Bidirectional Testing ──

  - 3.1 Bidirectional integration test:
      next:
        - if: "both provider and consumer pass"
          go: Done
        - go: 2.0 Endpoint loop

  - Done:
      type: terminate
      reason: Contract verified bidirectionally
